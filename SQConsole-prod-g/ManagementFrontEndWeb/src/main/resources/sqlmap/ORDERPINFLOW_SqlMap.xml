<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="ORDERPINFLOW" >
  <select id="selectOrderPinFlowByDTO" parameterClass="com.huateng.accor.orderpin.dto.OrderPinFlowQueryDTO" resultClass="java.util.HashMap" remapResults="true">
    <include refid="Commons.prefixSql"/>
    select
    		T1.ORDER_PIN_FLOW_ID as "orderPinFlowId",
    		T1.ORDER_CARD_PIN_ID as "orderPinId",
    		T1.ORDER_FLOW_NODE as "orderflowNode",
    		T1.OPERATE_TYPE as "operateType",
    		T1.MEMO  as "memo",
    		T1.CREATE_USER as "createUser",
    		T1.CREATE_TIME as "createTime",
    		T2.USER_NAME as "createUserName"
    	from 
    		TB_ENT_ORDER_PIN_FLOW T1 left join
    		TB_ENT_USER T2 on T1.CREATE_USER=T2.USER_ID
    	where
    		T1.DATA_STATE = '1'
    	and 
    		T2.DATA_STATE = '1'
    <dynamic>
      <isNotNull prepend="and" property="orderCardPinId">
        T1.ORDER_CARD_PIN_ID = #orderCardPinId:DECIMAL#
      </isNotNull>
      <isNotNull prepend="and" property="orderPinFlowId">
        T1.ORDER_PIN_FLOW_ID = #orderPinFlowId:DECIMAL#
      </isNotNull>
      
      <isNotNull prepend="and" property="operateType">
        T1.OPERATE_TYPE = #operateType:DECIMAL#
      </isNotNull>
      
    </dynamic>
    	ORDER BY T1.MODIFY_TIME,T1.ORDER_PIN_FLOW_ID DESC
    <include refid="Commons.suffixSql"/>
  </select>
</sqlMap>