/* * Copyright (C), 2002-2013, 苏宁易购电子商务有限公司 * FileName: SapInfoServiceImpl.java * Author:   12073942 * Date:     2013-4-19 上午10:40:46 * Description: //模块目的、功能描述       * History: //修改记录 * <author>      <time>      <version>    <desc> * 修改人姓名             修改时间            版本号                  描述 */package com.suning.svc.service.sap.info;import java.util.Date;import org.apache.log4j.Logger;import org.springframework.util.Assert;import com.suning.svc.constants.SapInfoConstants;import com.suning.svc.ibatis.dao.SapInfoDAO;import com.suning.svc.ibatis.model.SapInfo;import com.suning.svc.ibatis.model.SapInfoExample;import com.suning.svc.ibatis.model.SapInfoExample.Criteria;import com.suning.svc.service.sap.info.dto.ReceiptDto;import com.suning.svc.service.sap.info.result.ReceiptResult;/** *  * 记账回执服务实现 *  * @author LEO * @see [相关类/方法]（可选） * @since [产品/模块版本] （可选） */public class SapInfoReceiptService {    Logger logger = Logger.getLogger(SapInfoReceiptService.class);    /**     * TBL_SAP_INFO表数据访问对象     */    private SapInfoDAO sapInfoDAO;    public ReceiptResult receiptConfirm(ReceiptDto receiptDto) {        String transSeq = receiptDto.getTransSeq();        ReceiptResult result = new ReceiptResult();        result.setReceiptDto(receiptDto);        try {            // 创建更新字段            SapInfo record = new SapInfo();            record.setFlag(SapInfoConstants.FLAG_DONE);            record.setUpdatedTime(new Date());            // 创建更新条件            SapInfoExample example = new SapInfoExample();            Criteria criteria = example.createCriteria();            criteria.andTransSeqEqualTo(transSeq);            // 按条件选择性更新            // Preparing Statement: update TBL_SAP_INFO set FLAG = ? , UPDATED_TIME = ? where ( TRANS_SEQ = ? )            int updateResult = sapInfoDAO.updateByExampleSelective(record, example);            Assert.isTrue(updateResult != 0, "数据库更新失败");            logger.info("流水号为" + transSeq + "的记录确认成功");        } catch (Exception e) {            String errMsg = "确认流水号为" + transSeq + "的记录时发生错误：" + e.getMessage();            logger.error(errMsg);            result.fail("", errMsg);        }        return result;    }    /**     * @param sapInfoDAO the sapInfoDAO to set     */    public void setSapInfoDAO(SapInfoDAO sapInfoDAO) {        this.sapInfoDAO = sapInfoDAO;    }}