<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd" >
<sqlMap namespace="CARD_ROUTE" >
 
  <select id="selectCardCoute" resultClass="java.util.HashMap" parameterClass="com.allinfinance.univer.issuer.dto.txnManagement.CardRouteDTO" remapResults="true">
<include refid="Commons.prefixSql" />
	select 
	t1.bin_val as "binVal",
	substr(t1.max_bin,1,2) as "length",
	substr(t1.iss_ins_id_cd,3) as "issInsIdCd",
	t2.ins_nm as "insNm",
	t3.user_name as "userName",
	t1.rec_crt_ts as "recCrtTs" 
	from tbl_card_route t1,tbl_ins_inf t2,tb_ent_user t3
	where t1.iss_ins_id_cd=t2.ins_id_cd 
		and trim(t1.rec_upd_usr_id) = t3.user_id 
	<dynamic>
      <isNotEmpty prepend="and" property="binVal">
        t1.bin_val = #binVal:VARCHAR#
      </isNotEmpty>
       <isNotEmpty prepend="and" property="issInsIdCd">
        t1.iss_Ins_Id_Cd = #issInsIdCd:VARCHAR#
      </isNotEmpty>
     </dynamic>
     <include refid="Commons.suffixSql" />
  </select>
  
  <select id="selectIssuerInfoList" parameterClass="com.allinfinance.univer.issuer.dto.txnManagement.CardRouteDTO" resultClass="com.allinfinance.univer.issuer.dto.txnManagement.CardRouteDTO">	
 		  select 
 		  substr(ins_id_cd,3) as "issInsIdCd",
 		  ins_nm as "insNm"
 		  from tbl_ins_inf 
 		  where 1=1
 		  <dynamic>
 		    <isNotEmpty prepend="and" property="issInsIdCd">
      	      rel_ins_id_cd = #issInsIdCd:VARCHAR#
      	   </isNotEmpty>
 		  </dynamic>
 	</select>
</sqlMap>