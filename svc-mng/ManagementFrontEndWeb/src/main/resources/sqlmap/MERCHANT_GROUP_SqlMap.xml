<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="MERCHANT_GROUP">
  <select id="selectMerchantGroupByDTO" parameterClass="com.huateng.accor.merchantgroup.dto.MerchantGroupQueryDTO" resultClass="java.util.HashMap" remapResults="true">
    <include refid="Commons.prefixSql"/>
    select
        t1.MERCHANT_GRP_ID as "merchantGrpId", 
        t1.MERCHANT_GRP_NAME as "merchantGrpName",
        t1.ENGLISH_NAME as "englishName",
        decode(t1.STATE,'1','有效','0','无效') as "state",
        to_char(t1.create_time,'yyyy-MM-dd')    as "creatTime",
        t2.user_name    as  "createUser"
    from TB_ENT_MERCHANT_GROUP t1,
    	 tb_ent_user t2
    where t1.DATA_STATE = '1'
    and t1.create_user=t2.user_id(+)
    <dynamic>
      <isNotEmpty prepend="and" property="merchantGrpId">
        MERCHANT_GRP_ID = #merchantGrpId:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="merchantGrpName">
        MERCHANT_GRP_NAME like '%'||#merchantGrpName:VARCHAR#||'%'
      </isNotEmpty>
      <isNotNull prepend="and" property="state">
        STATE = #state:DECIMAL#
      </isNotNull>
    </dynamic>
        order by t1.CREATE_TIME DESC
    <include refid="Commons.suffixSql"/>
  </select>
</sqlMap>