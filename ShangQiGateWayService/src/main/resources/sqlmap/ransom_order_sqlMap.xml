<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ransomOrder">
	<select id="ransomPageSql" parameterClass="com.allinfinance.univer.seller.ransom.OrderRansomDTO"
		resultClass="java.util.HashMap" remapResults="true">
		<include refid="Commons.prefixSql" />
		select t.order_id "orderId",
		       c.customer_name "customerName",
		       s.seller_name "sellerName",
		       nvl(t.card_quantity, '0') "cardQuantity",
		       t.order_date "createDate",
		       u.user_name "userName",
		       t.order_state "orderState"
		  from tb_seller  s  right join tb_sell_order t on s.entity_id = t.process_entity_id ,
		       tb_customer   c,
		       tb_ent_user   u
		 where t.first_entity_id = c.entity_id
		   and u.user_id = t.create_user
		   and t.order_type = 70000001

		<dynamic>
			<isNotEmpty prepend="and" property="orderId">
				t.order_id = #orderId# 
			</isNotEmpty>
			<isNotEmpty prepend="and" property="entityName">
				t.customer_name = #entityName# 
			</isNotEmpty>
			<isNotEmpty prepend="and" property="createUser">
				u.user_name = #createUser#
			</isNotEmpty>
			
			<isNotEmpty prepend="and" property="order">
				t.order_state = #order#
			</isNotEmpty>
		</dynamic>
		
		<include refid="Commons.suffixSql" />
	</select>
	
	
	<select id="ransomOrderList" parameterClass="com.allinfinance.univer.seller.ransom.OrderRansomDTO"
		resultClass="java.util.HashMap" remapResults="true">
		<include refid="Commons.prefixSql" />
		select * 
			from tb_sell_order_list t 
		where t.order_id = #orderId# 
		<include refid="Commons.suffixSql" />
	</select>

	<select id="getCustomer" parameterClass="com.allinfinance.univer.seller.ransom.OrderRansomDTO"
		resultClass="com.allinfinance.univer.seller.customer.CustomerDTO" remapResults="true">
		
		select c.entity_id ,
		       c.customer_name          "customerName",
		       c.corp_name              "corpName",
		       c.corp_Phone             "corpPhone",
		       c.corp_Cred_Type         "corpCredType",
		       c.corp_Cred_Id           "corpCredId",
		       c.corp_Cred_Sta_Validity "corpCredStaValidity",
		       c.corp_Cred_End_Validity "corpCredEndValidity",
		       c.oper_Name              "operName",
		       c.oper_Phone             "operPhone",
		       c.oper_Cred_Type         "operCredType",
		       c.oper_Cred_Id           "operCredId",
		       c.oper_Cred_Sta_Validity "operCredStaValidity",
		       c.oper_Cred_End_Validity "operCredEndValidity"
		  from tb_customer c
		 where c.entity_id = #entityId#
		 

	</select>
</sqlMap>