<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ORDERFLOW">
	<select id="selectOrderFlow" resultClass="java.util.HashMap"
		parameterClass="com.allinfinance.univer.seller.order.dto.SellOrderFlowQueryDTO"
		remapResults="true">
		<include refid="Commons.prefixSql" />
		select
			T1.ORDER_FLOW_ID as "orderflowId",
			T1.ORDER_ID as "orderId",
			T1.ORDER_FLOW_NODE as "orderflowNode",
			T1.OPERATE_TYPE as "operateType",
			T1.MEMO as "memo",
			T1.CREATE_USER as "createUser",
			T1.CREATE_TIME as "createTime",
			T2.USER_NAME as "createUserName"
		from
			TB_SELL_ORDER_FLOW T1 left join 
			TB_ENT_USER T2 on T1.CREATE_USER=T2.USER_ID
		where
			T1.ORDER_ID = #orderId:VARCHAR#
			AND 
		T1.DATA_STATE = '1'
		and
		T2.DATA_STATE = '1'
		<dynamic>
			<isNotEmpty prepend="and" property="orderFlowId">
				T1.ORDER_FLOW_ID = #orderFlowId:VARCHAR#
      		</isNotEmpty>
			<isNotEmpty prepend="and" property="operateType">
				T1.OPERATE_TYPE = #operateType:VARCHAR#
      		</isNotEmpty>
		</dynamic>
		ORDER BY T1.MODIFY_TIME,T1.ORDER_FLOW_ID DESC
		
		<include refid="Commons.suffixSql" />
	</select>
</sqlMap>