<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="ISSUER_GROUP">

  <select id="selectIssuerGroup" resultClass="java.util.HashMap" parameterClass="com.huateng.accor.issuergroup.dto.IssuerGroupQueryDTO" remapResults="true">
    <include refid="Commons.prefixSql"/>
    	select 
    		T1.ISSUER_GROUP_ID as "issuerGroupId", 
    		T1.ISSUER_GROUP_NAME as "issuerGroupName", 
    		T1.ENGLISH_NAME as "englishName", 
    		T2.USER_NAME as "userName",
    		T1.STATE as "state", 
    		T1.MODIFY_TIME as "modifyTime" 
    	from 
    		TB_ENT_ISSUER_GROUP T1,TB_ENT_USER T2
    	where 
    		T1.MODIFY_USER=T2.USER_ID(+)	
    	and 
    		T1.DATA_STATE = '1'
    <dynamic>
      <isNotNull prepend="and" property="issuerGroupId">
        T1.ISSUER_GROUP_ID = #issuerGroupId:DECIMAL#
      </isNotNull>
      <isNotEmpty prepend="and" property="issuerGroupName">
        UPPER(T1.ISSUER_GROUP_NAME) like UPPER('%'||#issuerGroupName:VARCHAR#||'%')
      </isNotEmpty>
      <isNotEmpty prepend="and" property="englishName">
        UPPER(T1.ENGLISH_NAME) like UPPER('%'||#englishName:VARCHAR#||'%')
      </isNotEmpty>
      <isNotNull prepend="and" property="state">
        T1.STATE = #state:DECIMAL#
      </isNotNull>
    </dynamic>
    <include refid="Commons.suffixSql"/>
  </select>
  <select id="selectIssuer" resultClass="com.huateng.accor.issuer.dto.IssuerDTO" parameterClass="com.huateng.accor.issuergroup.dto.IssuerGroupDTO">
  	select 
  		T2.ISSUER_ID as issuerId,
  		T2.ISSUER_NAME as issuerName
  	from
  		TB_ENT_ISSUER_GROUP T1,
  		TB_ENT_ISSUER T2
  	where
  		T1.ISSUER_GROUP_ID=T2.ISSUER_GROUP_ID
  	and
  		T1.DATA_STATE='1'
  	and 
  		T2.DATA_STATE='1'
  <dynamic>
  		 <isNotNull prepend="and" property="issuerGroupId">
       		 T1.ISSUER_GROUP_ID = #issuerGroupId:DECIMAL#
     	 </isNotNull>
  </dynamic>
  </select>
  <select id="selectIssuerGroups" resultClass="com.huateng.accor.issuergroup.dto.IssuerGroupDTO">
  		select
  			ISSUER_GROUP_ID as "issuerGroupId",
  			ISSUER_GROUP_NAME as "issuerGroupName"
  		from
 			TB_ENT_ISSUER_GROUP
 		where
 			DATA_STATE='1'
  </select>
</sqlMap>
