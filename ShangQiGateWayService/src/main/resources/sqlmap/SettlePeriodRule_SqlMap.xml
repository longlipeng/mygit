<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="SETTLERULE">
  <select id="selectSettleRuleByDTO" parameterClass="com.allinfinance.univer.settleperiodrule.dto.SettlePeriodRuleQueryDTO" resultClass="java.util.HashMap" remapResults="true">
    <include refid="Commons.prefixSql"/>
    select
        T1.RULE_NO as "ruleNo",
        T1.RULE_NAME as "ruleName",
        to_char(to_date(subStr(T1.MODIFY_TIME,1,8),'yyyymmdd'),'yyyy-mm-dd') as "modifyTime",
        decode(T1.RULE_TYPE,'1','固定周期','0','非固定周期','2','混合周期') as "ruleType",
        decode(T1.PERIOD_TYPE,'D','按天数','W','按周数','M','按月数') as "periodType",
        T1.PERIOD as "period",
        decode(t1.amount_min,'',null,null,t1.amount_min,to_number(trim(t1.amount_min)))/100 as "amountMin",
        decode(T1.STATE,'1','新建','2','启用','0','删除') as "state",
        T1.ENTITY_ID as "entityId"
    from
        tb_settle_period_rule T1
    where
        1=1
    <dynamic>
      <isNotEmpty prepend="and" property="ruleNo">
        T1.RULE_NO like '%'||#ruleNo:VARCHAR#||'%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="ruleName">
        T1.RULE_NAME like '%'||#ruleName:VARCHAR#||'%'
      </isNotEmpty>
      <isNotEmpty prepend="and" property="state">
        T1.STATE = #state:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="ruleType">
        T1.RULE_TYPE = #ruleType:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="periodType">
        T1.PERIOD_TYPE = #periodType:VARCHAR#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="entityId">
        T1.ENTITY_ID = #entityId:VARCHAR#
      </isNotEmpty>
    </dynamic>
    <include refid="Commons.suffixSql"/>
  </select>
</sqlMap>